"use strict";(self["webpackChunkhappyhouse"]=self["webpackChunkhappyhouse"]||[]).push([[999],{1339:function(e,a,t){t.d(a,{Z:function(){return u}});var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("b-modal",{ref:"modal",staticClass:"bv-example-row",attrs:{id:"house-detail-modal",title:e.house.apartmentName},on:{hidden:e.CLEAR_HOUSE},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[t("div",[t("p",{staticClass:"float-left"}),e.check||null==e.userInfo?e._e():t("b-button",{staticClass:"float-right",attrs:{variant:"primary",size:"sm"},on:{click:e.addApt}},[e._v(" 관심지역 추가 ")]),e.check&&null!=e.userInfo?t("b-button",{staticClass:"float-right",attrs:{variant:"danger",size:"sm"},on:{click:e.deleteApt}},[e._v(" 관심지역 취소 ")]):e._e()],1)]},proxy:!0}])},[t("b-container",{attrs:{fluid:""}},[t("div",{staticStyle:{width:"400px",height:"300px"},attrs:{id:"newMap"}})])],1)},n=[],o=t(4665),i=t(1457);const r="houseStore",p="memberStore";var l={name:"HouseDetail",data(){return{map:null,markers:[]}},computed:{...(0,o.rn)(r,["house","houses","hospitals"]),...(0,o.rn)(p,["userInfo"]),check(){return"Y"==this.house.check}},methods:{...(0,o.OI)(r,["CLEAR_HOUSE"]),...(0,o.nv)(r,["getHouseDetail","getHospitalList"]),addApt(){(0,i.qP)({userid:this.userInfo.userid,aptCode:this.house.aptCode},(({data:e})=>{console.log(e);let a="등록 처리시 문제가 발생했습니다.";"success"===e.message&&(a="등록이 완료되었습니다.",this.house.check="Y",this.houses.push(this.house)),alert(a)}),(e=>{console.log(e)}))},deleteApt(){(0,i.Fh)({userid:this.userInfo.userid,aptCode:this.house.aptCode},(({data:e})=>{let a="삭제 처리시 문제가 발생했습니다.";"success"===e.message&&(a="삭제가 완료되었습니다.",this.house.check="N",this.houses.forEach(((e,a)=>{e.aptCode==this.house.aptCode&&this.houses.splice(a,1)}))),alert(a)}),(e=>{console.log(e)}))},makeMarkers(){this.markers=[];let e=null;var a=t(9325);this.hospitals.forEach((t=>{e=new kakao.maps.Marker({map:this.map,position:new kakao.maps.LatLng(parseFloat(t.wgs84Lat),parseFloat(t.wgs84Lon)),title:t.dutyName,image:new kakao.maps.MarkerImage(a,new kakao.maps.Size(35,35))}),this.markers.push(e);var s=new kakao.maps.InfoWindow({position:new kakao.maps.LatLng(t.wgs84Lat,t.wgs84Lon),content:`<div style="width:200px;\n          display: block;\n          background: #50627F;\n          color: #fff;\n          text-align: center;\n          height: 24px;\n          line-height:22px;\n          border-radius:4px;\n          padding:0px 10px;">${t.dutyName}</div>`});kakao.maps.event.addListener(e,"mouseover",this.makeOverListener(this.map,e,s)),kakao.maps.event.addListener(e,"mouseout",this.makeOutListener(s))}));var s=t(816);e=new kakao.maps.Marker({map:this.map,position:new kakao.maps.LatLng(parseFloat(this.house.lat),parseFloat(this.house.lng)),title:this.house.apartmentName,image:new kakao.maps.MarkerImage(s,new kakao.maps.Size(35,35))}),e.setMap(this.map),this.markers.push(e);var n=`<div style="width:350px; text-align:center; padding:5px;"><h5>${this.house.apartmentName}</h5></div>\n      <div style="width:350px; padding:5px">가격 : ${this.house.lowest},000 ~ ${this.house.highest},000원<br>\n      가까운 병원 : ${this.calculation()}</div>`,o=new kakao.maps.LatLng(this.house.lat,this.house.lng),i=new kakao.maps.InfoWindow({position:o,content:n});i.open(this.map,e)},initMap(){const e=document.getElementById("newMap"),a={center:new kakao.maps.LatLng(this.house.lat,this.house.lng),level:5};this.map=new kakao.maps.Map(e,a),this.map.setZoomable(!1)},setCenter(e,a){this.map.setCenter(new kakao.maps.LatLng(e,a))},makeOverListener(e,a,t){return function(){t.open(e,a)}},makeOutListener(e){return function(){e.close()}},calculation(){var e=Number.MAX_VALUE,a=-1;return this.hospitals.forEach(((t,s)=>{var n=parseFloat(t.wgs84Lat)-parseFloat(this.house.lat),o=parseFloat(t.wgs84Lon)-parseFloat(this.house.lng),i=Math.sqrt(Math.abs(n*n)+Math.abs(o*o));i<e&&(e=i,a=s)})),-1==a?"가까운 병원이 없습니다.":`${this.hospitals[a].dutyName}`}},mounted(){if(window.kakao&&window.kakao.maps)this.initMap();else{const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=b9ba0fdeea1c1db7ad7f71e4962d1bb3",e.addEventListener("load",(()=>{kakao.maps.load(this.initMap)})),document.head.appendChild(e)}this.makeMarkers()},updated(){if(window.kakao&&window.kakao.maps)this.initMap();else{const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=b9ba0fdeea1c1db7ad7f71e4962d1bb3",e.addEventListener("load",(()=>{kakao.maps.load(this.initMap)})),document.head.appendChild(e)}this.makeMarkers()}},h=l,d=t(1001),m=(0,d.Z)(h,s,n,!1,null,null,null),u=m.exports},9999:function(e,a,t){t.r(a),t.d(a,{default:function(){return u}});var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"mapview"},[t("div",{attrs:{id:"map"}}),t("house-detail",{ref:"detailModal"})],1)},n=[],o=t(4665),i=t(1339);const r="houseStore",p="memberStore";var l={components:{HouseDetail:i.Z},name:"HouseMap",data(){return{map:null,markers:[]}},created(){this.$emit("saveToggle",this.$route.name)},computed:{...(0,o.rn)(r,["house","houses","hospitals"]),...(0,o.rn)(p,["userInfo"])},methods:{...(0,o.nv)(r,["getHouseDetail"]),makeMarkers(){var e=this;if(this.markers.forEach((e=>{e.setMap(null)})),this.markers=[],0==this.houses.length)return;this.map.setCenter(new kakao.maps.LatLng(this.houses[0].lat,this.houses[0].lng));let a=null;var s=t(816);this.houses.forEach(((t,n)=>{a=new kakao.maps.Marker({map:this.map,position:new kakao.maps.LatLng(parseFloat(t.lat),parseFloat(t.lng)),title:t.apartmentName,image:new kakao.maps.MarkerImage(s,new kakao.maps.Size(35,35)),clickable:!0}),a.id="marker"+n,this.markers.push(a);var o=new kakao.maps.InfoWindow({position:new kakao.maps.LatLng(t.lat,t.lng),content:`<div style="width:200px;\n          display: block;\n          background: #50627F;\n          color: #fff;\n          text-align: center;\n          height: 24px;\n          line-height:22px;\n          border-radius:4px;\n          padding:0px 10px;">${t.apartmentName}</div>`});kakao.maps.event.addListener(a,"mouseover",this.makeOverListener(this.map,a,o)),kakao.maps.event.addListener(a,"mouseout",this.makeOutListener(o)),kakao.maps.event.addListener(a,"click",(function(){let a;a=null==e.userInfo?null:e.userInfo.userid,e.getHouseDetail({userid:a,aptCode:t.aptCode}),e.$refs.detailModal.$refs.modal.show()}))}))},initMap(){const e=document.getElementById("map"),a={center:new kakao.maps.LatLng(33.450701,126.570667),level:5};this.map=new kakao.maps.Map(e,a)},setCenter(e,a){this.map.setCenter(new kakao.maps.LatLng(e,a))},makeOverListener(e,a,t){return function(){t.open(e,a)}},makeOutListener(e){return function(){e.close()}}},watch:{houses:function(){this.makeMarkers()}},mounted(){if(window.kakao&&window.kakao.maps)this.initMap();else{const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=b9ba0fdeea1c1db7ad7f71e4962d1bb3",e.addEventListener("load",(()=>{kakao.maps.load(this.initMap)})),document.head.appendChild(e)}this.makeMarkers()}},h=l,d=t(1001),m=(0,d.Z)(h,s,n,!1,null,"3fee0a70",null),u=m.exports},816:function(e,a,t){e.exports=t.p+"img/flat.0a6df7e9.png"},9325:function(e,a,t){e.exports=t.p+"img/hospital.f1e3ea15.png"}}]);
//# sourceMappingURL=999.a93fa841.js.map